RewriteEngine On
RewriteBase /

# Skip if the request is for a real file or directory
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Homepage
RewriteRule ^$ index.php?controller=home&action=index [L,QSA]
RewriteRule ^home\.html$ index.php?controller=home&action=index [L,QSA]

# All products
RewriteRule ^products\.html$ index.php?controller=product&action=index [L,QSA]
# All products + sort (no pagination)
RewriteRule ^products/sort-([a-zA-Z0-9-_]+)\.html$ index.php?controller=product&action=index&sort=$1 [L,QSA]

# All products - with pagination
RewriteRule ^products/page-([0-9]+)\.html$ index.php?controller=product&action=index&page=$1 [L,QSA]
# All products - pagination + sort
RewriteRule ^products/page-([0-9]+)/sort-([a-zA-Z0-9-_]+)\.html$ index.php?controller=product&action=index&page=$1&sort=$2 [L,QSA]

# Filter by category (e.g., /products/category/electronics.html)
RewriteRule ^products/category/([a-zA-Z0-9-_]+)\.html$ index.php?controller=product&action=index&category=$1 [L,QSA]
# Filter by category + sort (no pagination)
RewriteRule ^products/category/([a-zA-Z0-9-_]+)/sort-([a-zA-Z0-9-_]+)\.html$ index.php?controller=product&action=index&category=$1&sort=$2 [L,QSA]

# Filter by category + pagination
RewriteRule ^products/category/([a-zA-Z0-9-_]+)/page-([0-9]+)\.html$ index.php?controller=product&action=index&category=$1&page=$2 [L,QSA]
# Filter by category + pagination + sort
RewriteRule ^products/category/([a-zA-Z0-9-_]+)/page-([0-9]+)/sort-([a-zA-Z0-9-_]+)\.html$ index.php?controller=product&action=index&category=$1&page=$2&sort=$3 [L,QSA]

# Search: /search/rice-cooker.html
RewriteRule ^search/([a-zA-Z0-9-]+)\.html$ index.php?controller=product&action=index&search=$1 [L,QSA]

# Search + pagination: /search/rice-cooker/page-2.html
RewriteRule ^search/([a-zA-Z0-9-]+)/page-([0-9]+)\.html$ index.php?controller=product&action=index&search=$1&page=$2 [L,QSA]

# Search + sort: /search/rice-cooker/sort-price-high.html
RewriteRule ^search/([a-zA-Z0-9-]+)/sort-([a-zA-Z0-9-]+)\.html$ index.php?controller=product&action=index&search=$1&sort=$2 [L,QSA]

# Search + sort + pagination: /search/rice-cooker/page-2/sort-price-high.html
RewriteRule ^search/([a-zA-Z0-9-]+)/page-([0-9]+)/sort-([a-zA-Z0-9-]+)\.html$ index.php?controller=product&action=index&search=$1&page=$2&sort=$3 [L,QSA]

# Product detail - more specific rule
RewriteRule ^product/([a-zA-Z0-9-]+)\.html$ index.php?controller=product&action=detail&slug=$1 [L,QSA,NC]

# Contact
RewriteRule ^contact\.html$ index.php?controller=home&action=contact [L,QSA]

# Login
RewriteRule ^login\.html$ index.php?controller=user&action=login [L,QSA]

# Register
RewriteRule ^register\.html$ index.php?controller=user&action=register [L,QSA]

# Forgot password
RewriteRule ^forgot-password\.html$ index.php?controller=user&action=forgotpassword [L,QSA]

# Shopping cart
RewriteRule ^cart\.html$ index.php?controller=cart&action=index [L,QSA]

# Checkout
RewriteRule ^checkout\.html$ index.php?controller=order&action=checkout [L,QSA]

# Admin panel
RewriteRule ^admin/?$ ../Admin/index.php [L,QSA]
RewriteRule ^admin/login\.html$ ../Admin/index.php?controller=home&action=login [L,QSA]

# Direct admin access
RewriteRule ^Admin/?$ ../Admin/index.php [L,QSA]

# Orders
RewriteRule ^orders\.html$ index.php?controller=order&action=index [L,QSA]

# Order detail
RewriteRule ^order/([0-9]+)\.html$ index.php?controller=order&action=detail&id=$1 [L,QSA]

# User profile
RewriteRule ^profile\.html$ index.php?controller=user&action=index [L,QSA]

# Edit profile
RewriteRule ^profile/edit\.html$ index.php?controller=user&action=editprofile [L,QSA]
